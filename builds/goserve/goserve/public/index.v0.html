<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="icon" type="image/x-icon"
        href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIiB2aWV3Qm94PSIwIDAgMCAwIDQwMCA0MDAiPjxnIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTM1NyAxMjRsLTMgNi00MiA0My00MiA0MnYxMDVjMiA4IDggMTMgMTUgMTVoNThjNy0zIDEzLTggMTQtMTZWMTI0IiBmaWxsPSIjYmMyMmYzIi8+PHBhdGggZD0iTTQxIDIxOWwxIDk5YzEgOCA3IDE1IDE1IDE3aDU3YzctMSAxMi03IDE0LTE0bDEtMlYyMTVsLTQyLTQyYy00NS00NS00My00My00NC00N2EyMyAyMyAwIDAgMS0xLTNjLTEtMS0xIDEtMSA5Nm0yNzEtNDZsLTQyIDQyIDQyLTQyIiBmaWxsPSIjZTMyYTc3Ii8+PHBhdGggZD0iTTkzIDY1Yy0yIDAtNSAxLTcgM2wtNDEgMzljLTMgNC00IDExLTMgMTV2MmwzIDYgMTA0IDEwNGMtNS02LTUtMTQgMC0yMWwyNi0yNiAyNS0yNi00NS00NC00Ny00N2MtNC00LTEwLTYtMTUtNSIgZmlsbD0iIzM0ZTNiYiIvPjxwYXRoIGQ9Ik0zMDEgNjVsLTggMy0xNDQgMTQ1Yy01IDctNCAxNSAwIDIxIDEgMyAzNyAzOCAzOSA0MCA4IDUgMTcgNCAyNC0xbDE0My0xNDRjNC02IDQtMTQtMS0yMWwtNDEtNDBjLTMtMy04LTQtMTItMyIgZmlsbD0iI2ZiZGIwNCIvPjxwYXRoIGQ9Ik0xNDUgMjIzbDEgMWExMyAxMyAwIDAgMCAwLTFoLTEiIGZpbGw9IiM2YzljOWMiLz48L2c+PC9zdmc+">
    <title>MikoSite</title>
    <!-- load in the head to prevent flash, but will slow the loading -->
    <script type="text/javascript" src="./libs.v0/icons.js"></script>
    <script type="text/javascript" src="./libs.v0/main.js"></script>
    <script type="text/javascript" src="./libs.v0/viewers.js"></script>
    <script type="text/javascript" src="./libs.v0/players.js"></script>
    <script type="text/javascript" src="./outLibs/spark-md5.min.js"></script>
    <script type="text/javascript" src="./outLibs/showdown.min.js"></script>
    <script type="text/javascript" src="./outLibs/highlight.min.js"></script>
    <style>
        * {
            font-family: sans-serif, 'Segoe UI', 'Sans', Arial, 'Microsoft Yahei', Helvetica;
        }

        *::-webkit-scrollbar {
            width: 6px;
            height: 6px;
            background-color: #f4f4f4;
        }

        *::-webkit-scrollbar-track {
            border-radius: 6px;
            background-color: #f4f4f4;
        }

        *::-webkit-scrollbar-thumb {
            border-radius: 6px;
            background-color: #888;
        }
    </style>

</head>

<body style="background-color: #f4f4f4; padding:0; margin:0;">
    <div class="mainPage"></div>
    <script>
        // if (window.location.pathname.indexOf("/home") != 0) window.open("/home", "_self"); // redirect to /home
        let host = window.location.host;
        let protocal = window.location.protocol;
	    let _host = host.slice(0, host.lastIndexOf(":"));
        let exIframes = {};
        let exLinks = {};
        let xhr = new XMLHttpRequest();
        xhr.open("GET", protocal + "//" + host + "/data/links.json", true);
        xhr.setRequestHeader("Cache-Control", "no-cache"); // disable cache
        xhr.onreadystatechange = () => {
            if (xhr.readyState == 4 && xhr.status == 200) {
                try {
                    exLinks = JSON.parse(xhr.responseText.replace(/\/\/__IP__:/g, "//" + _host + ":"));
                    new MainView({ box: document.querySelector('.mainPage'), topTitle: "MikoSite", exIframes: exIframes, exLinks: exLinks, }).refresh();
                } catch (error) {
                    new MainView({ box: document.querySelector('.mainPage'), topTitle: "MikoSite", exIframes: exIframes, exLinks: exLinks, }).refresh();
                }
            } else {
                new MainView({ box: document.querySelector('.mainPage'), topTitle: "MikoSite", exIframes: exIframes, exLinks: exLinks, }).refresh();
            }
        };
        xhr.send(null);
        
        
    </script>
</body>

</html>
